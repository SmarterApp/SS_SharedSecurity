/*******************************************************************************
 * Educational Online Test Delivery System 
 * Copyright (c) 2014 American Institutes for Research
 *   
 * Distributed under the AIR Open Source License, Version 1.0 
 * See accompanying file AIR-License-1_0.txt or at
 * https://bitbucket.org/sbacoss/eotds/wiki/AIR_Open_Source_License
 ******************************************************************************/
package org.opentestsystem.shared.security.domain.permission;

import java.io.Serializable;
import java.util.Iterator;
import java.util.List;

import org.apache.commons.lang.builder.ToStringBuilder;
import org.apache.commons.lang.builder.ToStringStyle;

public class SbacPermissionRole implements Serializable {
    private static final long serialVersionUID = 8669247712033969388L;
    private final String PROTECTED = "PROTECTEDROLE";

    private List<SbacPermissionEntity> allowableEntities;
    private String roleName;
    private List<SbacPermissionMapping> mappings;

    private boolean protectedRole = false;

    /**
     * @return the allowableEntities
     */
    public List<SbacPermissionEntity> getAllowableEntities() {
        return this.allowableEntities;
    }

    /**
     * @param inAllowableEntities the allowableEntities to set
     */
    public void setAllowableEntities(final List<SbacPermissionEntity> inAllowableEntities) {
        this.allowableEntities = inAllowableEntities;
        for (Iterator<SbacPermissionEntity> iterator = this.allowableEntities.iterator(); iterator.hasNext(); ) {
            SbacPermissionEntity sbacPermissionEntity = iterator.next();
            if (sbacPermissionEntity.getEntity().equals(PROTECTED)) {
                protectedRole = true;
                iterator.remove();
            }
        }
    }

    public boolean isProtected() {
        return protectedRole;
    }

    /**
     * @return the roleName
     */
    public String getRole() {
        return this.roleName;
    }

    /**
     * @param inRole the roleName to set
     */
    public void setRole(final String inRole) {
        this.roleName = inRole;
    }

    public List<SbacPermissionMapping> getMappings() {
        return this.mappings;
    }

    public void setMappings(final List<SbacPermissionMapping> inMappings) {
        this.mappings = inMappings;
    }

    @Override
    public String toString() {
        return ToStringBuilder.reflectionToString(this, ToStringStyle.SHORT_PREFIX_STYLE);
    }
}
